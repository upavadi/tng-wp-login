# **Wordpress-TNG Login Widget** # 
## **Download**
There is no download version released. You may tryout beta version 1.0.3.beta. 

 - Beta version is under test
 - http://trial.upavadi.net/ 
 - http://www.upavadi.net/

## **License**
The code is licenced under the [MIT licence](http://opensource.org/licenses/MIT)

## **Introduction**
This widget replicates the Wordpress login/log out task and also logs into TNG ( The Next Generation of Genealogy Sitebuilding )](http://www.tngsitebuilding.com/).
- Adds a Registration Form which may replace the Wordpress registration form by deselecting 'Membership>Anyone can register' in Wordpress Dashboard>Settings.
- Adds a User Profile page which saves the changes in Wordpress and TNG database
- Adds an enhanced Password-Reset module which checks for the presence of email of registered user.
- Almost all the text used in pages and emails is customisable by the administrator.
- User may login using either registered user Name or email. On successful login, if User Name exists in TNG database, the user is also logged in to TNG.

## **Compatibility**
- The plugin is under Beta Test and is tested on TNG 10.1.3
- PHP version 5.4 - 5.6.40
-  Wordpress V 4.9 - 5.1 platform
- A Wordpress twenty Twelve child theme. (Not tested in any other theme)

## **Issues**
**WP-TNG Integration** is achieved by displaying TNG content within Wordpress wrapper. 
To my knowledge, there are 2 methods available for achieving this.

1. **Mark Barnes method** (MB-Method) uses a plugin to replace WP page with TNG content.
At the moment, this plugin has some conflicts with displaying TNG media and the issue is not resolved.
2. **Cees Kloosterman Method** (CK-Method) Uses customized Header and Footer files by replacing TNG Header and footers by Hard coding topmenu.php, footer.php and meta.php. This is a very simple and effective method and I have now converted my live site (and Beta test site) from MB-Method to CK-Method. The plugin is tested using this integration method.
3. **Page Refresh** may be required to see successful TNG login. 


## **Activation**
On activation, 
 - plugin inserts following pages if they do not exist. 

Wordpress Page | Slug | Shortcode 
---------------|------|----------
Registration   | 'wp-tng-registration'| [user_registration] 
Profile        |  'wp-tng-profile'    |[user_profile]
Password Reset |'wp-tng-resetPassword'| [reset_Password_form]
Password Lost  | 'wp-tng-lostPassword'| [lost_Password_form]

- Plugin checks for the path to TNG folder. If it cannot locate the folder, administrator is prompted to submit TNG Root (absolute) Path  and if tng folder found, plugin is activated. 

## **New Registration Form**
  **A link to registration form is included in the login widget.**
 - If submitted User Name is in WP and/or TNG  database and  submitted email is not,  'User Name in use' error is generated. 
 - If sumbmitted email is in WP database, user is requested to Try Password Reset.
 - If submitted email is only in TNG, administrator is alerted via email.
 - New registrations are entered in Wordpress and TNG User tables.
 - In TNG,  user awaits Review.
 - In Wordpress, user is allocated 'Subscriber' role. 
 - For this to be effective, deselect Membership: Anyone can register in Wordpress Dashboard>Settings. 
  - New user will receive an email generated by the plugin.
  - Email is sent to Administrator for new registrations, password reset alerts.
  - If there is an anamoly in data, email is sent to administrator with detail s of the data held.



## Password Reset: 
 - Some Wordpress Password-Reset routines are re-written. 
 -  Password reset is only allowed if the submitted email is in Wordpress database. 
 - If the submitted email is in TNG database only, email is sent to administrator with credential details and submitter is requested to await a response from the administrator.

## **Customized Text**
**All text is held in config.json file and can be edited by going to admin panel and accessing via admin menu,**
- **WP-TNG-Login**
  - **Plugin Paths**: Enter TNG absolute path, Tng URL and Name of TNG photo folder
  - **Login Text:** Enter text for Greeting,page and slug names for profile and registration   
  - **Captcha Keys** Enable Captcha and enter Keys
  - **Profile Page** Here you can control the text of all the labels and enable/disable additional interest fields
  - **Registration Page** Here you can control the text of all the labels and enable/disable additional interest fields
  - **Registration Messages** Edit Registration Success Message, Registration Success Email and Introduction text 
  - Password-Reset Messages
  - **Password-Reset Messages** New registration alert to suggest password reset, Text for Forgot Password message and  Email




